<section class="my-2 container mx-auto">
  <div class="flex justify-center">
    <div class="w-5/12">
      <textarea class="textarea textarea-primary w-full" placeholder="Say something..." [(ngModel)]="postContent" ></textarea>
      <div class="flex justify-end">
        <button (click)="createPost()" class="btn btn-primary">Create post</button>
      </div>
    </div>
  </div>
</section>

@if (findAllPosts(); as data) {
  @for(post of data; track post) {
    <div class="container mx-auto flex justify-center my-12">
      <div class="card w-5/12 bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">
            <div class="avatar">
              <div class="w-12 rounded-full">
                <img src="https://daisyui.com/images/stock/photo-1534528741775-53994a69daeb.jpg" />
              </div>
            </div>
            <div class="font-semibold text-md">
              {{ post.userName }}
              <div class="text-xs">
                {{ post.posted_at | date: 'MMM d, y, hh:mm' }}
              </div>
            </div>
          </h2>
          <p class="mt-3">{{ post.content }}</p>
        </div>
        <div class="ml-3 flex items-center gap-3 p-5">
          <div>
            <button class="btn btn-square" [class.text-red-500]="post.liked" (click)="likePost(post.id, !post.liked)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
              </svg>
            </button>
          </div>
          <div>
            <button class="btn" (click)="toggleModal(post.id)">See coomments</button>
          </div>
        </div>
      </div>
    </div>
  }
} @else {
  <div class="container mx-auto flex justify-center my-12">
    <div class="card w-5/12 shadow-xl ">
      <div class="card-body">
        <h2 class="card-title">
          <div class="avatar">
            <div class="w-12 rounded-full skeleton">
            </div>
          </div>
          <div class="font-semibold text-md skeleton w-36 h-9"></div>
        </h2>
        <p class="mt-3 h-24 skeleton"></p>
      </div>
      <div class="ml-4 flex items-center gap-3 p-5">
        <div>
          <button class="btn btn-square skeleton">
          </button>
        </div>
        <div>
          <button class="btn skeleton w-28"></button>
        </div>
      </div>
    </div>
  </div>
}

<dialog id="my_modal_1" class="modal" [open]="modal()">
  <div class="modal-box">
    <section class="mb-1">
      <textarea class="textarea w-full textarea-primary" placeholder="Say something..."></textarea>
      <div class="flex justify-end mt-1">
        <button class="btn btn-primary">Place comment</button>
      </div>
    </section>
    @if (findAllComments(); as data) {
      @if (data.length) {
        <h3 class="font-bold text-lg mb-5">All comments</h3>
        @for (comment of data; track comment) {
          <section class="border p-3 rounded-lg border-gray-600 my-3">
            <div class="flex items-center gap-2">
              <div class="avatar">
                <div class="w-10 rounded-full">
                  <img src="https://daisyui.com/images/stock/photo-1534528741775-53994a69daeb.jpg" />
                </div>
              </div>
              <div class="font-semibold">
                {{ comment.userName }}
              </div>
            </div>
            <p class="py-4"> {{ comment.content }}</p>
          </section>
        }
      } @else {
        <h3 class="font-bold text-lg mb-5">No comments yet</h3>
      }
    }
    <div class="modal-action">
      <button class="btn" (click)="toggleModal()">Close</button>
    </div>
  </div>
</dialog>
<div [class.hidden]="!modal()" class="bg-[#0006] dark:bg-bg-[#0006] fixed inset-0 z-40"></div>
